<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>Git Worflows</title>

		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/solarized.css">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="lib/css/solarized-dark.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match(/print-pdf/gi) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName('head')[0].appendChild(link);
		</script>
	</head>
	<body>
		<div class="reveal">
			<div class="slides">
				<section>
					<section data-background="images/ao-labs.jpg" style="color:#000">
						<h1 style="color:#000">Git Workflows</h1>

						<p>Slides by Matthew Gray</p>
						<p>
							<small>
								<br>hey@matthew.nz
								<br>https://matthew.nz
								<br>https://github.com/heymatthew
							</small>
						</p>

						<p>Special thanks to</p>
						<p>
							<small>
								<br><strong>Jef Vratney:</strong> Opportunity setting and guidance
								<br><strong>Section 6:</strong> Compatibility advice and feedback
							</small>
						</p>
					</section>

					<section data-markdown>
						## Rough Timeline
						9:30 - 12
						- Setup and Overview
						- Personal Workflows

						12:30 - 5
						- Team Workflows
						- Release workflows

						Tomorrow Onsite for Help
					</section>

					<section data-markdown>
						## Why Git?
						* Flexability
						* Tooling
						* Speed
						* Momentum
					</section>

					<section data-markdown>
						## SVN Comparison
						* Decentralised, every clone is an entire copy
						* Branches contain entire history
						* Git tracks content
						* SVN tracks deltas
					</section>

					<section data-markdown>
						Git thinks in Snapshots, Not Differences

						> The major difference between Git and any other VCS (Subversion and friends included)
						> is the way Git thinks about its data.

						src: git-scm.com, ch 1.3 Getting Started: Git Basics
					</section>

					<section>
						<p>SVN commits</p>
						<div>
							<img src="images/branches-svn.png" alt="svn branching strategy">
						</div>
						<p>Git commits</p>
						<div>
							<img src="images/branches-commits.png" alt="git history">
						</div>
					</section>

					<section data-markdown>
						## Setup

						Git

						https://git-scm.com/download/win

						Tortose Git

						https://tortoisegit.org/

						Git pad

						https://github.com/github/GitPad

						Yes! "...use gitpad as your default editor for git"
					</section>

					<section data-markdown>
						## Configure
						```bash
						git config --global user.name "Matthew B. Gray"
						git config --global user.email "code@matthew.nz"
						git config --list
						git config --list --show-origin
						```

						--global stores your global settings

						Default puts settings into your repo
					</section>

					<section data-markdown>
						## Docs
						For help on git config, git has a help page
						```bash
						git help $command
						git help config
						```
					</section>

					<section data-markdown>
						## Exercise
						- Using `git help`, pull up pages on `git config`
						- Use help to find out how to unset `user.email`
						- List configurations with `--list --show-origin`
						- Open your .gitconfig file, how are fields saved?
					</section>
				</section>

				<section>
					<section data-markdown>
						## Personal Workflows 1
						- Immediate productivity: Build and commit to repos
						- Anatomy of a commit: Fields and behaviours
						- Staging files: Steps leading to a commit
						- All about Branches: Create and delete branches
					</section>

					<section data-markdown>
						## Immediate productivity
						Create a git repo

						```bash
						mkdir test
						cd test
						git init
						git status
						```
					</section>

					<section data-markdown>
						## Immediate productivity
						Adding and resetting files in the staging area
						```bash
						git status
						git add myfile.txt
						git reset myfile.txt
						git status
						```

						Whole directories too
						```bash
						git add .
						git add myfolder
						git reset myfolder
						```
					</section>

					<section data-markdown>
						## Immediate productivity
						Commit your staged changes

						```bash
						git commit
						```

						If you make a whoops, with an "empty" file

					</section>

					<section data-markdown>
						## Immediate productivity
						Delete a git repo

						```bash
						rmdir /S .git
						git status
						```
					</section>

					<section data-markdown>
						## Exercise time!
						Create a repo and commit to it
						```
						mkdir test_repo
						cd test_repo
						git init
						git add
						git commit
						```

						HOT TIP

						Set verbose on commit and commit another file
						```
						git config --global commit.verbose true
						git add
						git commit
						```
					</section>

					<section data-markdown>
						## Exercise time 2!
						Lookup help pages on git commit
						```
						git help
						```

						Based on help hints, remove a file and commit
					</section>

					<section data-markdown>
						## Anatomy of a commit
						Commits are
						- Immutable
						- SHA1 Hashed
						- Built on
							- File contents
							- Timestamp
							- Author
							- Parent or parents
					</section>

					<section>
						<p>One more time in context</p>
						<div>
							<img src="images/branches-commits.png" alt="git history">
						</div>
					</section>

					<section data-markdown>
						## Anatomy of a commit
						Commits can be seen with
						```
						git show
						git log
						```
						And referenced by
						- Hash
						- Branch
						- HEAD
						- Relative to other commits
					</section>

					<section data-markdown>
						## Anatomy of a commit
						Looking at a commit
						```
						git show
						```
						```
						commit d5401a6399234ddfe7bc986a0fe120359505aad5 (HEAD -> master)
						Author: Matthew B. Gray &lt;code@matthew.nz&gt;
						Date:   Mon Oct 13 13:01:15 2017 -0800

								All of the things

						diff --git a/bar.txt b/bar.txt
						new file mode 100644
						index 0000000..7bcc722
						--- /dev/null
						+++ b/bar.txt
						@@ -0,0 +1 @@
						+the bar has a bar tender
						\ No newline at end of file
						diff --git a/fu.txt b/fu.txt
						new file mode 100644
						index 0000000..f2e93e3
						--- /dev/null
						+++ b/fu.txt
						@@ -0,0 +1 @@
						+a fu enters the bar
						\ No newline at end of file
						```
					</section>

					<section data-markdown>
						## Anatomy of a commit
						Raw commit
						```
						git show
						```
						```
						commit d5401a6399234ddfe7bc986a0fe120359505aad5
						Author: Matthew B. Gray &lt;code@matthew.nz&gt;
						Date:   Mon Oct 13 13:01:15 2017 -0800

								All of the things

						:000000 100644 0000000... 7bcc722... A  bar.txt
						:000000 100644 0000000... f2e93e3... A  fu.txt
						:000000 100644 0000000... bc979a6... A  lib/flubber.txt
						:000000 100644 0000000... e69de29... A  lib/flubber2.txt
						```
					</section>

					<section data-markdown>
						## Exercise time!
						What is the difference between
						```
						git show
						git show HEAD
						git show master
						```

						You can get at relative commits by appending ~, try it
						```
						git show HEAD~
						git show master~
						```

						Find the parent commit with `git log`

						Make log show all but the last commit with `HEAD~`
					</section>

					<section data-markdown>
						## Staging files

						![staged, unstages, commits, and stashes](images/staging-area.png)
					</section>

					<section data-markdown>
						## Staging files
						Lets talk about Test Driven Development

						1. write test, RED
						2. git add
						3. write code, GREEN
						4. git add, git commit
						5. REFACTOR
						6. git commit
					</section>

					<section data-markdown>
						## Staging files
						Staging files can be done in parts
						```
						git add -p
						```

						Unstaging files can be done in parts too
						```
						git reset -p
						```
					</section>

					<section data-markdown>
						## Staging files
						If you want to reset to a GREEN state
						```
						git checkout .
						git checkout myfile.txt
						git status
						```

						This doesn't affect added files
						```
						git add -p
						git checkout .
						git status
						```
					</section>

					<section data-markdown>
						## Exercise time!
						1. Make changes to 2 files already committed
						2. Change 1 of them
						3. Checkout everything
						```
						git checkout .
						```
						What changed?

						How could you get rid of your staged changes?
					</section>

					<section data-markdown>
						## All about Branches
						Master is the default branch in git

						Create branches with
						```
						git branch mybranch
						```

						Checkout branches with
						```
						git checkout mybranch
						```
					</section>

					<section data-markdown>
						## All about Branches
						List branches with
						```
						git branch
						```

						...list all branches with -a
						```
						git branch -a
						```
					</section>

					<section data-markdown>
						## All about Branches
						Delete branches with
						```
						git branch -d mybranch
						```
						It complains if this is the only copy, such as
						- When another branch isn't referencing it
						- When it's not shared / pushed

						...use -D to go ahead deleting the only copy
					</section>

					<section data-markdown>
						## All about Branches
						Lets talk about immutability!
					</section>

					<section data-markdown>
						## Exercise time!
					</section>
				</section>

				<section>
					<section data-markdown>
						TODO https://filezilla-project.org/sourcecode.php

						```
						git svn clone https://svn.filezilla-project.org/svn/FileZilla3
						```

						```
						Initialized empty Git repository in /Users/mbgray/code/training/freightways/FileZilla3/.git/
						W: +empty_dir: brances
						W: +empty_dir: tags
						W: +empty_dir: trunk
						r1 = 1cecc4b6b4a907327130da10ca56f049b7e98101 (refs/remotes/git-svn)
							A	trunk/src/interface/Mainfrm.h
							A	trunk/src/interface/LocalTreeView.cpp
							A	trunk/src/interface/RemoteTreeView.cpp
							A	trunk/src/interface/LocalTreeView.h
						...
						```
					</section>
				</section>

				<section>
					<section data-markdown>
						## Personal Workflows 2
						- Searching and Testing: How to find missing stuff
						- Reset the world: Moving branches around arbitrarily
						- Diffs and Commits: Tips for review
						- Merge stuff, break stuff: Integrate your work
					</section>
				</section>

				<!-- Course Overview -->
				<section>
					<div data-markdown>
						## Course Overview
						--------------------------------------------------------------------------------
						* Getting Started
						* Personal workflows
						* Team workflows
						* Release workflows
					</div>

					<aside class="notes" data-markdown>
						* 5 minute breaks on the hour
						* 9:30 - 12:00 Basics and Personal workflows
						* 12:30 - 5:00 Team and Release workflows
					</aside>
				</section>

				<section>
					<section data-markdown>
						* **Getting Started** <-- you are here
						* Personal workflows
						* Team workflows
						* Release workflows
						--------------------------------------------------------------------------------
						## Overview: Getting started
						- Basic config for these machines
						- Good config defaults
						- Quick review of basic git
					</section>

					<section data-markdown>
						Exercise time!

						* Init desktop
						* Open in explorer
						* git status
						* git add
						* git commit
						* setting up your user
					</section>

					<section data-markdown>
						### Basic config for these machines

						Git would like you to specify

						1. Your full name
						1. Your email address
						1. Your favourite text editor

						```
						git config --global user.name "Dr. Henry Killinger"
						git config --global user.email "fu@bar.baz"
						git config --global core.editor vim
						```

						All these settings are storred in **~/.gitconfig**
					</section>

					<section data-markdown>
						### Sane defaults for day to day use

						* Use colour to highlight branches and diffs
						* Make sure you only push the branch you're on
						* Show branches and tags in git log
						* Setup rebase as the default strategy for git pull

						```
						git config --global color.ui always
						git config --global push.default current
						git config --global log.decorate full
						git config --global branch.rebase true
						git config --global branch.autosetuprebase always
						```

						All these settings are storred in **~/.gitconfig**
					</section>

					<section>
						<h3>Quick review of basic git</h3>
						<p>
							<a href="pages/git-cheatsheet.html" target="_blank">
								http://ndpsoftware.com/git-cheatsheet.html
							</a>
						</p>
						<div><img alt="git cheetsheet" src="images/qr-cheatsheet.png" style="border:0"></div>
					</section>
				</section>

				<!-- Personal workflows -->
				<section>
					<section data-markdown>
						* Getting Started
						* **Personal workflows** <-- you are here
						* Team workflows
						* Release workflows
						--------------------------------------------------------------------------------
						## Overview: Personal workflows
						- Context hunting / Isolate and Triage issues
						- Mastering branches
						- Audit work interactively
						- Manage merge conflicts like a pro
					</section>

					<section>
						<h3>Typical git workflow</h3>
						<img src="images/individual-workflow.svg" height="500" alt="personal workflow">
					</section>

					<section>
						<h3>Tools suited to personal workflow</h3>
						<div data-markdown>
							- Personal workflows...
							- **Isolate and Triage: Context hunting** <-- you are here
							- Work: Mastering branches
							- Update, Test: Audit work interactively
							- Share: Manage merge conflicts like a pro
						</div>
						<img src="images/individual-workflow.svg" height="500" alt="personal workflow">
					</section>

					<section data-markdown>
						### Context hunting / Isolate, Triage
						----------------------------------------
						BEFORE YOU START, helps isolate and triage

						Context is important when you start to

						1. Avoid regressing your codebase
						2. Find out if code is still under warantee
						3. Get help if you get stuck, seek out a human
						----------------------------------------

						- Personal workflows...
							- Isolate and Triage: Context hunting
								* Log - Show commit logs
								* Blame - revision and author for lines of a file
								* Pickaxe - Search commit diffs for changes
					</section>

					<section> <!-- Git log -->
						<div data-markdown>
							### Context hunting / Isolate, Triage
							- Personal workflows...
								- Isolate and Triage: Context hunting
									* Log <-- you are here
									* Blame
									* Pickaxe
							----------------------------------------
						</div>
						<div data-markdown class="fragment current-visible" style="position:absolute;">
							Regular log
							```
							git log
							```
							![regular git log](images/git-log.png)
						</div>
						<div data-markdown class="fragment current-visible" style="position:absolute;">
							Show me contents of patches
							```
							git log -p
							```
							![patch mode git log](images/git-log-p.png)
						</div>
						<div data-markdown class="fragment current-visible" style="position:absolute;">
							Show me a summary of patches
							```
							git log --stat
							```
							![stats](images/git-log-stat.png)
						</div>
						<div data-markdown class="fragment current-visible" style="position:absolute;">
							Find changes associated with text in a commit message:
							```
							git log --grep '$search_term'
							git log --grep 'bug#1234'
							```
							![grep for messages](images/git-log-grep-term.png)
						</div>
					</section>

					<section data-markdown> <!-- Git blame -->
						### Context hunting / Isolate, Triage
						- Personal workflows...
							- Isolate and Triage: Context hunting
								* Log
								* Blame <-- you are here
								* Pickaxe
						----------------------------------------
						Basic usage
						```
						git blame $filename
						git show $hash
						```
						Ignore whitespace
						```
						git blame -w $filename
						```
						Copy paste detection in a file, and across the repo
						```
						git blame -M $filename
						git blame -C $filename
						```
					</section>

					<section> <!-- Git pickaxe -->
						<div data-markdown>
							### Context hunting / Isolate, Triage
							- Personal workflows...
								- Isolate and Triage: Context hunting
									* Log
									* Blame
									* Pickaxe <-- you are here
							----------------------------------------
							```
							git log -S 'some distinct line that changed'
							git log --stat -S '$racebook_uri_result'
							```
							* Find all the changes to a line in your entire history
							* The pickaxe can help find code thatâ€™s been deleted or moved
							* Typically helps you with questions like
							 - What happened to myFabuliousFunc()?
							 - When did $mySillyVariable get referenced everywhere?

							* Works with log, diff, and format-patch
						</div>
					</section>

					<section>
						<div data-markdown>
							### Activity: Testing log, pickaxe, blame and show
							1. Clone jquery repo
							2. Use git log to find fixes to issue #14756
							3. Use pickaxe to find commits that added or removed 'parseFloat'
							4. Try git blame on the .gitignore file
							5. With this info, show the commit that blacklisted bower_components

							```
							git clone https://github.com/jquery/jquery
							git log --grep 'asdf'
							git log -S 'asdf'
							git blame $file
							git show $hash
							```
						</div>
					</section>

					<section>
						<h3>Tools suited to personal workflow</h3>
						<div data-markdown>
							- Personal workflows...
								- Isolate and Triage: Context hunting
								- **Work: Mastering branches** <-- you are here
								- Update, Test: Audit work interactively
								- Share: Manage merge conflicts like a pro
						</div>
						<img src="images/individual-workflow.svg" height="500" alt="personal workflow">
					</section>

					<section>
						<h3>Mastering branches: Overview</h3>
						<div data-markdown class="fragment current-visible" style="position:absolute">
							![](images/branches-typical.png)
							![](images/branches-multi.png)

							Typical branching, images from http://git-scm.com
						</div>
						<div data-markdown class="fragment current-visible" style="position:absolute">
							![](images/branches-perspective.png)

							How branches can be used for workflow
						</div>
						<div data-markdown class="fragment current-visible" style="position:absolute">
							* Nodes represent diffs with respect to each other
							* Nodes represent entire filesystem layout on their own
							* Nodes are immutable

							----------------------------------------
							You can describe nodes with a...

							* **branch**			- a name to track your work
							* **tag**					- a label, it doesn't move
							* **commit hash**	- complete history and set of files
							* **HEAD**				- your current checkout
							* **$ref^**   		- above are $refs, chain ^ or ~ to go up a branch

							----------------------------------------

							Lets look at how we can use these with commands
						</div>
					</section>

					<section>
						<h3>Mastering branches: Commands</h3>
						<div data-markdown>
							Interesting commands with branches
							```
							git checkout $branch
							git reset $ref
							git rebase $branch
							git rebase --interactive $branch
							```
							----------------------------------------
							* **Checkout**: context dependent command...
								1. Either reset unstaged file(s)
								2. Or switch branches
							* **Rebase**: Batch move commits and rewrite history
							* **Reset**: Move branches around arbitarily
							* **Reflog**: Save my ass! What have I had 'checked out' recently?
							----------------------------------------
							Whiteboard time!
						</div>
					</section>

					<section data-background-image="images/oops.gif">
						<div data-markdown>
							```
							# NOES!! Undo!!
							git reflog
							```
						</div>
					</section>

					<section>
						<h3>Mastering branches: Headless state</h3>
						<div data-markdown>
							If you're not on a branch, git puts you in a headless state
							```
							git checkout $tag
							git checkout $commit
							```
						</div>
						<div data-markdown>
							Trying something like this...
							```
							git checkout HEAD^
							```
							Results in something like this...
						</div>
						<div data-markdown>
							```
							You are in 'detached HEAD' state. You can look around, make experimental
							changes and commit them, and you can discard any commits you make in this
							state without impacting any branches by performing another checkout.

							If you want to create a new branch to retain commits you create, you may
							do so (now or later) by using -b with the checkout command again. Example:

							git checkout -b new_branch_name

							HEAD is now at f4b37d8... CSS: Return values should be numbers
							```
							Which is git being melodramatic
						</div>
					</section>

					<section>
						<div data-markdown>
							### Activity: Mastering Branches
							1. Navigate to your Jabberwocky repo clone
							2. Checkout 'master'
							3. Fix the bug, commit
							4. Interactive rebase onto the tag v1
							5. Squash your fix with 'Oops' and give it a message.

							```
							cd $jabberwocky_dir
							vim jabberwocky.html
							git add jabberwocky.html
							git commit
							git log
							git rebase $ref --interactive
							git log -p
							```

							...it's as if the error was never there.

							Now put it back
							```
							git reset origin/master --hard
							```
						</div>
					</section>

					<section>
						<h3>Tools suited to personal workflow</h3>
						<div data-markdown>
							- Personal workflows...
								- Isolate and Triage: Context hunting
								- Work: Mastering branches
								- **Update, Test: Audit work interactively** <-- you are here
								- Share: Manage merge conflicts like a pro
						</div>
						<img src="images/individual-workflow.svg" height="500" alt="personal workflow">
					</section>

					<section>
						<div data-markdown>
							### Audit work interactively
							Audit your work interactively with your staging area

							1. When you're ready to commit locally
							2. When you want to break up a monstor commit

							----------------------------------------
							### Quick activity
							Add your own verse to the jabberwocky poem, then run
							```
							git add -p
							```
							Check what's happened with
							```
							git status
							```
							Put stuff back with
							```
							git reset HEAD
							```
						</div>
					</section>

					<section>
						<h3>Tools suited to personal workflow</h3>
						<div data-markdown>
							- Personal workflows...
								- Isolate and Triage: Context hunting
								- Work: Mastering branches
								- Update, Test: Audit work interactively
								- **Share: Manage merge conflicts like a pro** <-- you are here
						</div>
						<img src="images/individual-workflow.svg" height="500" alt="personal workflow">
					</section>

					<section>
						<div data-markdown>
							### Manage merge conflicts like a pro
							Source control is about social coding and interactions.

							A conflict should be a conversation. When you see
							```
							CONFLICT (content): Merge conflict in jabberwocky.html
							Automatic merge failed; fix conflicts and then commit the result.
							```
							Get info with
							```
							git status
							git blame $file
							```
							Markers are usually HEAD and a $ref, wher

							1. HEAD is work of yours
							2. $ref is the thing you're in conflict with

							```
							git reflog
							git merge $ref
							```
						</div>
					</section>
				</section>

				<section>
					<section data-markdown>
						* Getting Started
						* Personal workflows
						* **Team workflows** <-- you are here
						* Release workflows
						--------------------------------------------------------------------------------
						## Overview: Team workflows
						- Quickly setup local, network accessible repos
						- Working with people who dont enjoy source control
						- Clean history, rebase verses merge
					</section>

					<section>
						<img src="images/share.gif" alt="lion king, throwing simba as a metaphor for sharing">
					</section>

					<section data-markdown>
						TODO
						Pull Requests
						Listing all branches
						Checking out a branch
						Tracking a branch upstream
						Comparing 2 local repos, how remotes show up
						- Create a branch
						- Push and track a branch
						- 
					</section>

					<section>
						<div data-markdown>
							### Quickly setup local, network accessible repos
							![](images/dictator-lieutenant-contributors.png)
						</div>
					</section>

					<section>
						<div data-markdown>
							### Quickly setup local, network accessible repos
							Git just tracks content. All history is stored in .git directory, and sharing
							is just mushing content around in there.

							To modify remotes...
							```
							git remote add $alias $location
							git remote rm $alias $location
							```
							Location can be...

							1. ssh://[user@]host.xz[:port]/path/to/repo.git/
							1. git://host.xz[:port]/path/to/repo.git/
							1. http[s]://host.xz[:port]/path/to/repo.git/
							1. ftp[s]://host.xz[:port]/path/to/repo.git/
							1. rsync://host.xz/path/to/repo.git/
						</div>
					</section>

					<section>
						<div data-markdown>
							### Quickly setup local, network accessible repos
							Share your terrible poetry with your neighbour.

							This is for unauthenticated read-only access.
							```
							cd ~/jabberwocky/.git
							touch git-daemon-export-ok
							git daemon --reuseaddr --base-path=~/jabberwocky/ ~/jabberwocky/
							```
							Where ~/jabberwocky is the jabberwocky checkout.

							When this is setup, exchange details and try clone...
							```
							git clone git://$host/ jabberwocky-neighbour
							cd jabberwocky-neighbour
							```
							or add a remote...
							```
							git remote add git://$host/ neighbour
							git fetch --all
							git log neighbour/master
							git diff neighbour/master master
							```
						</div>
					</section>

					<section>
						<div data-markdown>
							### Working with people who don't enjoy source control
							Idea #1: Empower them, let them mange their commits, but manage their merges

							![](images/branches-typical.png)
						</div>
					</section>

					<section>
						<div data-markdown>
							### Working with people who don't enjoy source control
							Idea #2: Manage their commits and merges

							```
							while true; do
								clear;
								git add .
								git commit -m "$designer updated UX."
								sleep 5;
							done;
							```
						</div>
					</section>

					<section>
						<div data-markdown>
							### Clean history, rebase verses merge
							* When to merge: If you've pushed it, you can't change things without pain.
							* If you have multiple conflicts, try for a merge
							* Use KISS where possible

							----------------------------------------
							Discuss:
							```
							git pull --rebase
							```
							```
							git config --global branch.autosetuprebase always
							git pull
							```
							```
							git rebase --abort
							git merge --abort
							```
						</div>
					</section>
				</section>

				<section>
					<section>
						<div data-markdown>
							* Getting Started
							* Personal workflows
							* Team workflows
							* **Release workflows** <-- you are here
							--------------------------------------------------------------------------------
							## Overview: Release workflows
							- Strategies for dealing with release requirements
							- Strategies for database patching on branches
						</div>
					</section>

					<section data-markdown>
						# Changelogs
					</section>

					<section data-markdown>
						# Reviewing between refs
					</section>

					<section> <!-- Git bisect -->
						<div data-markdown>
							### Context hunting / Isolate, Triage
							- Personal workflows...
								- Isolate and Triage: Context hunting
									* Log
									* Bisect <-- you are here
									* Blame
									* Pickaxe
							----------------------------------------
						</div>
						<div data-markdown class="fragment current-visible" style="position:absolute;">
							To start bisecting, you use these commands
							```
							git bisect start $bad_commit $good_commit
							```
							'Unwanted' behaviour?
							```
							git bisect bad
							```
							'Wanted' behaviour?
							```
							git bisect good
							```
							Tidy up
							```
							git bisect reset
							```
						</div>
						<div data-markdown class="fragment current-visible" style="position:absolute;">
							Sometimes it's guess work
							```
							git bisect skip
							```

							Sometimes it's complicated to get back to your guess spot
							```
							git bisect log > bisect.log
							git bisect reply bisect.log
							```
						</div>
					</section>

					<section>
						<div data-markdown>
							### Activity: Testing bisect
							1. Clone the jabberwocky repo, pull tags
							2. Checkout the changes made with git log
							3. Use bisect with v1 and v2 tags as good/bad commits
							4. find the commit that broke the page
							```
							git clone https://github.com/heymatthew/jabberwocky
							git fetch --tags
							git log -p
							git log --stat
							git bisect start $bad $good
							```
							Exhibits wanted behaviour?
							```
							git bisect good
							```
							Exhibits unwanted behaviour?
							```
							git bisect bad
							```
						</div>
					</section>

					<section>
						<div data-markdown> Tidy up with
							```
							git bisect reset
							```
						</div>
					</section>

					<section data-markdown>
						# Reverting commits
					</section>

					<section data-markdown>
						# Reverting merges
					</section>

					<section data-markdown>
						# Branching Strategies
						Production support: Things that are great for any release strategy
						- Diff between points
						- Reverting commits
						- Reverting merges
						- Logic vs State vs Data
						- Backpatching
						- Bisecting
							-	Straight forward
								- git bisect start HEAD 3.0.0
								- git bisect good / bad / skip
								- git bisect reset
							- With data state
								- git bisect start 3.1.0 3.0.0
								- git bisect log
								- git checkout REF FOLDER
								- update state
								- git checkout -f .
								- git bisect good / bad / skip
							- When you need to come back to something
								- git bisect start
								- git bisect good / bad / skip
								- git bisect reflog

						Release strategies

						Tags vs Branches

						Linear History (SVN-ish)
						- Work on master
						- Branch at release time
						- Cherry pick to master on patch releases

						Merge Forward Releases
						- Branch with scoped work
						- Work on release branch till ready
						- Tag for release

						Feature releases with linear history
						- Branch from production
						- Work till test complete
						- Merge to master
						- Branch at release time
						- Merge to release branch for hotfixes
						- Merge release branch into master on hotfix release

						Feature Based Releases
						- Branch features from Production
						- Work till ready, merge releases back into your branches
						- Create release candidates by octo merging heads

						Microkernel Architecture
						- Either break your repository up and use package dependencies to manage code
							- git mv $file $folder
						- Or break your repository up using folders, and manage your dependencies with something like docker tags
						  - git tag
							- git filter-branch OR git mv $file $folder
							- great for controlling commit access and security requirements
							- e.g. banking APIs
					</section>

					<section data-markdown>
						TODO: Beyond here
						1. review slides
						2. migrate what you need
					</section>

					<section data-markdown>
						### Database patching on branches
						Git doesn't care about non-filesystem entities

						Database patching is important to get right

						----------------------------------------

						You can either use convetion, or process to manage this

						1. Numeric patch - set 1+$current in your filename
						2. Automatic numeric patch - use a merge script on release
					</section>

					<section>
						<div data-markdown>
							### Strategies for dealing with release requirements
							The battle of flexability vs simplicity

							----------------------------------------

							* Track changes, find bugs and release when you can
							* Working on releases in parallel
							* Construct release candidates based on feature sets
							* Release partial applications (modular)
						</div>
					</section>

					<section data-background-image="images/personal-workflows.gif">
						<h3>Release all the things!</h3>
					</section>

					<section>
						<div data-markdown>
							### Release requirements: Linear history
							* Simple
							* Track changes, find bugs and release when you can
							* Easy to bring new devs on board

							![](images/basic-branching-1.png)
							![](images/basic-branching-2.png)
						</div>
					</section>

					<section>
						<div data-markdown>
							### Release requirements: Merge forward releases
							* Fairly simple
							* Work on multiple releases at the same time
							* Can work on upstream while downstream is still going

							![](images/release-branches.png)
						</div>
					</section>

					<section>
						<div data-markdown>
							### Release requirements: Feature releases
							* Every piece of work is a feature
							* Features are octo-merged into a release candidate
							* Need to track production somehow
							* Cannot release 'backwards'

							![](images/feature-releases-1.png)
						</div>
					</section>

					<section>
						<div data-markdown>
							### Feature releases... omg
							![](images/feature-releases-2.png)
						</div>
					</section>

					<section>
						<div data-markdown>
							### Feature releases... more woah
							![](images/feature-releases-3.png)
						</div>
					</section>

					<section>
						<div data-markdown>
							### Release requirements: Microkernel architecture
							* Difficulty is abstracted to the application
							* Modules of application can be worked on at the same time
							* Release would package together multiple pieces of work

							![](images/basic-branching-2.png)
							![](images/release-branches.png)
						</div>
					</section>

					<section>
						<h1>Each has it's costs, choose the one that works best</h1>
					</section>
				</section>

				<section>
					<h2>Further Reading</h2>
					<ul>
						<li>
							<a href="http://git-scm.com">git-scm.com</a>
							- An ebook with plenty of gitty goodness
						</li>
						<li>
							Schwern's talk:
							<a href="http://www.youtube.com/watch?v=1ffBJ4sVUb4">Git for ages 4 and up</a>
						</li>
						<li>
							man git-workflows
						</li>
					</ul>
					<hr>
					<h2>Attribution</h2>
					<ul>
						<li><a href="http://git-scm.com">git-scm.com</a> for some images</li>
						<li><a href="http://devopsreactions.tumblr.com/post/50800607139">devops reactions</a> for awesome animated gifs</li>
						<li><a href="https://github.com/hakimel/reveal.js">reveal.js</a> for unbad slides</li>
					</ul>
				</section>

				<section data-markdown>
					## Course Information
					Slides can be found on

					[github.com/heymatthew/git-workflow-slides](
						https://github.com/heymatthew/git-workflow-slides
					)

					![qr for quick access](images/github-qr-link.png)

					Feedback? Corrections? Questions?

					Please leave an issue against the course github page.
				</section>

				<section data-markdown>
					Big finish

					![Boom](images/big-end.gif)
				</section>
			</div>
		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>

		<script>
			// More info about config & dependencies:
			// - https://github.com/hakimel/reveal.js#configuration
			// - https://github.com/hakimel/reveal.js#dependencies
			Reveal.initialize({
				history: true,
				dependencies: [
					{ src: 'plugin/markdown/marked.js' },
					{ src: 'plugin/markdown/markdown.js' },
					{ src: 'plugin/notes/notes.js', async: true },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
				]
			});
		</script>
	</body>
</html>
